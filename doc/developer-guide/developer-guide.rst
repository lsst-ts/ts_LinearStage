###########################
LinearStage Developer Guide
###########################

The LinearStage is a standard salobj supported CSC.
The hardware communicates via a RS-232 Serial cable.

.. _developer-guide:developer-guide:dependencies:

Dependencies
============

* `SAL <https://ts-sal.lsst.io>`_ - v4.0.0
* `ts_salobj <https://ts-salobj.lsst.io>`_ - v6.x.0
* `zaber-serial <https://www.zaber.com/support/docs/api/core-python/0.9.1/>`_ - v0.9.1

.. Linking to the previous versions may also be worthwhile, depending on the CSC

.. _developer-guide:developer-guide:api:

LinearStage API
===============

The content in this section is autogenerated from docstrings.

.. The code below should insert the docstrings from the code.

.. automodapi:: lsst.ts.LinearStage
    :no-main-docstr:
    :no-inheritance-diagram:


.. _developer-guide:developer-guide:build:

Build and Test
==============

.. prompt:: bash

    setup -kr .
    scons

.. prompt:: bash

    pip install .[dev]
    pytest --cov lsst.ts.LinearStage -ra


.. _developer-guide:developer-guide:usage:

Usage
=====
The deployment environment is a docker container for each LinearStage CSC used.

The LST stages use a RS-232 serial connector.
You'll need a RS-232 to USB converter in order to plug the device into the computer.
Plug in the usb cable into the computer.
There should be a udev rule that changes the port location to ``/dev/ttyLinearStage``.
Plugging in a second stage follows the same steps.
You may need to create a udev rule in order to get a nice symbolic location for the device.
If that rule does not exist, the device(s) will be found in ``/dev/ttyUSB{0,1}``


.. code::

    run_linear_stage.py 1
    # run_linear_stage.py 2 this is the index of the CSC

.. _developer-guide:developer-guide:simulator:

Simulator
=========

There is an experimental simulator for the LinearStage.
It is meant primarily for running the unit tests of the CSC.


.. _developer-guide:developer-guide:firmware:

Updating Firmware of the LinearStage
====================================

The firmware for this stage cannot be updated.


.. _developer-guide:developer-guide:documentation:

Building the Documentation
==========================

This is run from the CSC development container.

.. code::

    package-docs clean && package-docs build

.. _developer-guide:developer-guide:contributing:

Contributing
============

Code and documentation contributions utilize pull-requests on GitHub.
Feature requests can be made by filing a Jira ticket with the `LinearStage` label.
In all cases, reaching out to the :ref:`contacts for this CSC <ts_xml:index:master-csc-table:LinearStage>` is recommended.

